<!-- views/partials/index/reviews.ejs -->
 <!-- ---------------------------------------------------------
   ‚≠ê Customer Reviews Carousel
--------------------------------------------------------- -->
<section id="reviews" class="py-5">
	<div class="container">
        <!-- üü¶ Section Heading -->
		<h2 class="text-center mb-4"><%= __('reviews.title', 'Ce que disent nos √©l√®ves') %></h2>

        <!-- üü¶ Carousel Wrapper -->
		<% if (reviews && reviews.length > 0) { %>
		<div
			id="reviewsCarousel"
			class="carousel slide"
			data-bs-ride="carousel"
            aria-label="<%= __('reviews.carousel_label', 'Ce que disent nos √©l√®ves') %>"
			aria-roledescription="carousel"
		>
			<!-- Indicators -->
			<div class="carousel-indicators">
				<% reviews.forEach((_, index) => { %>
				<button
					type="button"
					data-bs-target="#reviewsCarousel"
					data-bs-slide-to="<%= index %>"
					class="<%= index === 0 ? 'active' : '' %>"
					aria-label="<%= __('reviews.show_review') %> <%= index + 1 %>"
				></button>
				<% }) %>
			</div>

			<!-- Slides -->
			<div class="carousel-inner" >
				<% reviews.forEach((review, index) => { %>
				<div class="carousel-item rating-block <%= index === 0 ? 'active' : '' %>" role="listitem">

					<div class="card review-card shadow-sm mx-auto rounded p-4">

						<!-- Reviewer -->
						<div class="d-flex align-items-center mb-3">
							<!-- Reviewer Photo -->
							<img
								class="review-photo mx-3 rounded-circle"
								src="<%= review.profile_photo_url %>"
								alt="<%= __('reviews.photo_of', 'Photo of') %> <%= review.author_name %>"
								referrerpolicy="no-referrer"
								loading="lazy"
							/>
							<div>
								<!-- Reviewer Name -->
								<h5 class="mb-1 fw-bold">
									<%= review.author_name %>
								</h5>

								<!-- Rating Stars -->
								<div class="rating-stars <%= review.rating === 5 ? 'perfect-rating' : '' %>"
									role="img"
									aria-label="<%= review.rating %> <%= review.out_of_5 %>"
									>
									<% for (let i = 1; i <= 5; i++) { %>
										<i class="bi <%= i <= review.rating ? 'bi-star-fill' : '' %>"></i>
									<% } %>
								</div>
							</div>
						</div>

						<!-- Review Text -->
						<blockquote class="review-text blockquote mb-2">
							<p class="clamp">‚Äú<%= review.text %>‚Äù</p>
						</blockquote>

						<!-- Google Translation and Branding -->
						<div class="d-flex justify-content-around align-items-center g-brand">
							<% if(review.review_lang.slice(0, 2) !== currentLang) { %>
							<a href="https://translate.google.com/?sl=auto&tl=<%= currentLang %>&text=<%= review.text %>" target="_blank">
								<i class="bi bi-translate"></i>
								<%= LANG_DATA[currentLang].label %>
							</a>
							<% } else { %>
								<span></span>
							<% } %>
							<img
								src="images/icons/google.svg"
								alt="Google"
								loading="lazy"
								referrerpolicy="no-referrer"
							/>
						</div>
					</div>
				</div>
				<% }) %>
			</div>

			<!-- Controls -->
			<button
				class="carousel-control-prev"
				type="button"
				data-bs-target="#reviewsCarousel"
				data-bs-slide="prev"
			>
				<span
					class="carousel-control-prev-icon"
					aria-hidden="true"
				></span>
				<span class="visually-hidden"><%= __('reviews.buttons.previous','Avis pr√©c√©dent') %></span>
			</button>
			<button
				class="carousel-control-next"
				type="button"
				data-bs-target="#reviewsCarousel"
				data-bs-slide="next"
			>
				<span
					class="carousel-control-next-icon"
					aria-hidden="true"
				></span>
				<span class="visually-hidden"><%= __('reviews.buttons.next', 'Avis suivant') %></span>
			</button>
		</div>

		<% } else { %>
		<p class="text-center text-muted"><%= __('reviews.none') %></p>
		<% } %>
	</div>
</section>
